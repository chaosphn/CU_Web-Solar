<div class="container-fluid report-component">
    <div class="row no-gutters h-100 ">
        <div class="col-12 group h-100">
            <div class="header row no-gutters">
                <div class="d-flex align-items-center selector" *ngIf="buildingList.length > 0" style="margin-right: 7px;">
                    <mat-form-field class="mat-selects">
                        <mat-select [(ngModel)]="siteSelected">
                            <ng-container *ngFor="let item of buildingList; let i = index">
                                <mat-option *ngIf="item.display" [value]="item" (click)="selectSite(item)">
                                  {{item.name}}
                                </mat-option>
                              </ng-container>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="d-flex align-items-center selector" style="margin-right: 7px;">
                    <mat-form-field class="mat-selects">
                        <mat-select [(value)]="selectedReport">
                            <mat-option *ngFor="let report of reportConfig" [value]="report">
                                {{report.Name}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="d-flex align-items-center">
                    <app-time-control [pickerType]="'calendar'" [startView]="getStartView(selectedReport?.Type)"
                    style="margin-right: 7px;"
                    (selectDatetime)="onDateTimeChange($event)" [dateTime]="dateTime"></app-time-control>
                </div>
                <div class="d-flex align-items-center">
                        <span class="btn-ok" (click)="getResponseData()">VIEW</span>
                        <span class="btn-ok" >SAVE XLS</span>
                        <span class="btn-ok" (click)="htmltoPDF()">SAVE PDF</span>
                </div>
            </div>
            <div class="content bz">
                <div id="htmlTable" class="report-content bz" *ngIf="selectedReport && selectedReport.ExchangeRate && selectedReport.Co2Rate && selectedReport.OilRate && selectedReport.TreeRate && dataTable.length > 0">
                    <div class="report-header d-flex-sb w-100 bz">
                        <div><img src="assets/images/cu.png" alt="" srcset=""></div>
                        <div class="d-col header-info">
                            <span class="topic">{{selectedReport.Name}}</span>
                            <span class="topic">{{dateTime | date: selectedReport.DateFormat }}</span>
                            <span class="topic">{{siteSelected.name}}</span>
                        </div>
                        <div><img src="assets/images/mea.png" alt="" srcset=""></div>
                    </div>
                    <div class="report-info w-100 bz">
                        <div class="row-info">
                            <span class="bz topic">Energy Production:</span>
                            <span class="bz">{{ (getSummaryData("SUM", 1) | myNumber2: '1.0-2') }} kWh</span>
                            <span class="bz"></span>
                            <span class="bz topic">Financial Saving:</span>
                            <span class="bz">{{ (getSummaryData("SUM", 1) | myNumber: '1.0-2') * selectedReport.ExchangeRate | myNumber: '1.0-2' }} THB</span>
                        </div>
                        <div class="row-info">
                            <span class="bz topic">CO<sub>2</sub> Reduction:</span>
                            <span class="bz">{{ (getSummaryData("SUM", 1) | myNumber: '1.0-2') * selectedReport.Co2Rate | myNumber: '1.0-2' }} Kg</span>
                            <span class="bz"></span>
                            <span class="bz topic">Oil Saving:</span>
                            <span class="bz">{{ (getSummaryData("SUM", 1) | myNumber: '1.0-2') * selectedReport.OilRate | myNumber: '1.0-2' }} Liters</span>
                        </div>
                        <div class="row-info">
                            <span class="bz topic">Tree Saving:</span>
                            <span class="bz">{{ (getSummaryData("SUM", 1) | myNumber: '1.0-2') * selectedReport.TreeRate | myNumber: '1.0-2' }} Trees</span>
                            <span class="bz"></span>
                            <span class="bz"></span>
                            <span class="bz"></span>
                        </div>
                    </div>
                    <div class="report-table bz w-100">
                        <table *ngIf="dataTable.length > 0" class="brd">
                            <thead>
                                <tr>
                                    <th class="brd" [style.width]="head.width" *ngFor="let head of selectedReport.Header">{{head.title}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let row of dataTable | orderBy: 0">
                                    <td class="brd" *ngFor="let col of row; index as j;">
                                        <span *ngIf="j==0">{{col | date: selectedReport.Header[0].type}}</span>
                                        <span *ngIf="j!=0">{{col}}</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="brd row-summary" *ngFor="let sum of selectedReport.Header; index as i;">
                                        <span *ngIf="sum.display">{{sum.display}}</span>
                                        <span *ngIf="!sum.display">{{getSummaryData(sum.type, i) | myNumber2: '1.0-2'}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="report-chart bz" *ngIf="dataTable && chart">
                        <div [style.height]="'100%'" [chart]="chart">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>